<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Alexandru T. Codilean" />

<meta name="date" content="2025-02-25" />

<title>Brief introduction to R</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="site_libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">SCII205</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fab fa-r-project"></span>
     
    Computer Labs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="r1.html">Brief introduction to R</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Spatial data in R:</li>
    <li>
      <a href="r2.html">Part 1. Making a map</a>
    </li>
    <li>
      <a href="r3.html">Part 2. Data I/O and geoprocessing operations</a>
    </li>
    <li>
      <a href="r4.html">Part 3. Operations on continuous fields</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Case studies:</li>
    <li>
      <a href="r5.html">1. Mapping COVID spread and mortality</a>
    </li>
    <li>
      <a href="r6.html">2. Vegetation trends under a changing climate</a>
    </li>
    <li>
      <a href="r7.html">3. Mapping koala habitat suitability</a>
    </li>
    <li>
      <a href="r8.html">4. Trace metal contamination of soils</a>
    </li>
    <li>
      <a href="r9.html">5. Modelling runoff</a>
    </li>
    <li>
      <a href="r10.html">6. RUSLE soil erosivity during El Niño/La Niña</a>
    </li>
    <li>
      <a href="r11.html">7. Least Cost Path analysis of past human mobility</a>
    </li>
  </ul>
</li>
<li>
  <a href="lectnotes.html">
    <span class="fa fa-rectangle-list"></span>
     
    Lecture Notes
  </a>
</li>
<li>
  <a href="downloads.html">
    <span class="fa fa-cloud-arrow-down"></span>
     
    Downloads
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Brief introduction to R</h1>
<h3 class="subtitle">SCII205: Introductory Geospatial Analysis /
Practical No. 1</h3>
<h4 class="author">Alexandru T. Codilean</h4>
<h4 class="date">2025-02-25</h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>R is a powerful programming language and software environment
designed primarily for statistical computing and graphics. Developed in
the early 1990s, R has grown into one of the most widely used tools for
data analysis, enabling users to perform tasks ranging from basic
statistical tests to complex data modeling and visualization. Its
extensive collection of packages, contributed by a global community,
enhances its functionality and allows researchers, statisticians, and
data scientists to apply a variety of analytical methods to diverse
datasets.</p>
<p>The language’s open-source nature, governed by the GNU General Public
License, has fostered a robust ecosystem where users continuously
improve and expand its capabilities. Integrated development environments
such as RStudio further simplify coding, debugging, and data
visualization, making R accessible to both beginners and experts. Today,
R is widely used across academic, governmental, and commercial sectors,
underlining its importance as a key tool in the modern data-driven
landscape.</p>
<p>In this introduction, we will cover the essentials of R, including
basic syntax, data structures, reading data files, and plotting. By the
end, you should have a working knowledge of how to handle common data
analysis tasks in R.</p>
<p><font size="3"><svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg">
<path d="M436.67,184.11a27.17,27.17,0,0,1-38.3,0l-22.48-22.49a27.15,27.15,0,0,1,0-38.29l50.89-50.89a.85.85,0,0,0-.26-1.38C393.68,57,351.09,64.15,324.05,91c-25.88,25.69-27.35,64.27-17.87,98a27,27,0,0,1-7.67,27.14l-173,160.76a40.76,40.76,0,1,0,57.57,57.54l162.15-173.3A27,27,0,0,1,372,253.44c33.46,8.94,71.49,7.26,97.07-17.94,27.49-27.08,33.42-74.94,20.1-102.33a.85.85,0,0,0-1.36-.22Z" style="fill:none;stroke:#000;stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"></path>
<path d="M224,284c-17.48-17-25.49-24.91-31-30.29a18.24,18.24,0,0,1-3.33-21.35,20.76,20.76,0,0,1,3.5-4.62l15.68-15.29a18.66,18.66,0,0,1,5.63-3.87,18.11,18.11,0,0,1,20,3.62c5.45,5.29,15.43,15,33.41,32.52" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></path>
<path d="M317.07,291.3c40.95,38.1,90.62,83.27,110,99.41a13.46,13.46,0,0,1,.94,19.92L394.63,444a14,14,0,0,1-20.29-.76c-16.53-19.18-61.09-67.11-99.27-107" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></path>
<path d="M17.34,193.5l29.41-28.74a4.71,4.71,0,0,1,3.41-1.35,4.85,4.85,0,0,1,3.41,1.35h0a9.86,9.86,0,0,0,8.19,2.77c3.83-.42,7.92-1.6,10.57-4.12,6-5.8-.94-17.23,4.34-24.54a207,207,0,0,1,19.78-22.6c6-5.88,29.84-28.32,69.9-44.45A107.31,107.31,0,0,1,206.67,64c22.59,0,40,10,46.26,15.67a89.54,89.54,0,0,1,10.28,11.64A78.92,78.92,0,0,0,254,88.54,68.82,68.82,0,0,0,234,87.28c-13.33,1.09-29.41,7.26-38,14-13.9,11-19.87,25.72-20.81,44.71-.68,14.12,2.72,22.1,36.1,55.49a6.6,6.6,0,0,1-.34,9.16l-18.22,18a6.88,6.88,0,0,1-9.54.09c-21.94-21.94-36.65-33.09-45-38.16s-15.07-6.5-18.3-6.85a30.85,30.85,0,0,0-18.27,3.87,11.39,11.39,0,0,0-2.64,2,14.14,14.14,0,0,0,.42,20.08l1.71,1.6a4.63,4.63,0,0,1,0,6.64L71.73,246.6A4.71,4.71,0,0,1,68.32,248a4.86,4.86,0,0,1-3.41-1.35L17.34,200.22A4.88,4.88,0,0,1,17.34,193.5Z" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></path></svg>
<strong>R packages</strong></font></p>
<p>The practical will primarily utilise R functions from the following
packages:</p>
<ol style="list-style-type: decimal">
<li><p>The <strong>tidyverse</strong>: is a collection of R packages
designed for data science, providing a cohesive set of tools for data
manipulation, visualization, and analysis. It includes core packages
such as <strong>ggplot2</strong> for visualization,
<strong>dplyr</strong> for data manipulation, <strong>tidyr</strong> for
data tidying, and <strong>readr</strong> for data import, all following
a consistent and intuitive syntax.</p></li>
<li><p>The <strong>GGally</strong> package: GGally is an extension of
<strong>ggplot2</strong> that simplifies the creation of complex plots
and multi-panel visualizations. It provides functions like
<code>ggpairs</code> to quickly generate comprehensive pairwise plots,
making it easier to explore relationships in multivariate data.</p></li>
</ol>
<p><font size="3"><svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg">
<path d="M256,160c16-63.16,76.43-95.41,208-96a15.94,15.94,0,0,1,16,16V368a16,16,0,0,1-16,16c-128,0-177.45,25.81-208,64-30.37-38-80-64-208-64-9.88,0-16-8.05-16-17.93V80A15.94,15.94,0,0,1,48,64C179.57,64.59,240,96.84,256,160Z" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></path>
<line x1="256" y1="160" x2="256" y2="448" style="fill:none;stroke:#000;stroke-linecap:round;stroke-linejoin:round;stroke-width:32px"></line></svg>
<strong>Resources</strong></font></p>
<ul>
<li>Comprehensive documentation for R is available on the <a
href="https://www.r-project.org/other-docs.html">R Documentation
page</a>.</li>
<li>The <strong>tidyverse</strong> library of packages <a
href="https://www.tidyverse.org/learn/">documentation</a>.</li>
<li>The <strong>GGally</strong> package <a
href="https://ggobi.github.io/ggally/">documentation</a>.</li>
</ul>
</div>
<div id="getting-started-with-r" class="section level1">
<h1>Getting Started with R</h1>
<p>Before diving into data analysis, it is important to understand some
of the basic building blocks of R. The following section will cover
fundamentals such as the basic syntax of the R language and main data
structures.</p>
<div id="basic-syntax-and-data-types" class="section level2">
<h2>Basic Syntax and Data Types</h2>
<p>R is an interpreted language, meaning that you can execute commands
interactively in the R console or by running scripts.</p>
<div id="arithmetic-operations" class="section level3">
<h3>Arithmetic Operations</h3>
<p>Main arithmetic operators include additions (<code>+</code>),
subtraction (<code>-</code>), multiplication (<code>*</code>), division
(<code>\</code>), raising to a power (<code>^</code>), etc.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>x<span class="sc">+</span>y</span></code></pre></div>
<pre><code>## [1] 57</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>x<span class="sc">*</span>y</span></code></pre></div>
<pre><code>## [1] 350</code></pre>
</div>
<div id="relational-operations" class="section level3">
<h3>Relational Operations</h3>
<p>Relational operators are used to compare between values. Relational
operators available in R, include:</p>
<ul>
<li>less than: <code>&lt;</code></li>
<li>greater than: <code>&gt;</code></li>
<li>less than or equal to: <code>&lt;=</code></li>
<li>greater than or equal to: <code>&gt;=</code></li>
<li>equal to <code>==</code></li>
<li>not equal to <code>!=</code></li>
</ul>
<p><em>Note!</em>: There is a difference between the <em>equal to</em>
operator (<code>==</code>) and <code>=</code> which is used to assigned
values to a variable (see below).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">7</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>x<span class="sc">&lt;</span>y</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>x<span class="sc">&gt;</span>y</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>x<span class="sc">==</span><span class="dv">50</span></span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="assignment" class="section level3">
<h3>Assignment</h3>
<p>R uses <code>&lt;-</code> or <code>=</code> to assign values to
variables. For example:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>y <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>z <span class="ot">&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co"># z will now hold the value 30</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a>z</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
</div>
</div>
<div id="data-structures" class="section level2">
<h2>Data Structures</h2>
<p>R supports several types of data structures. The most common ones
include:</p>
<div id="vectors" class="section level3">
<h3>Vectors</h3>
<p>Vectors are one of the most fundamental data structures in R. They
are used to store sequences of data. We can use the function
<code>c()</code> (as in concatenate) to make vectors in R.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>numbers <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">7</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Alice&quot;</span>, <span class="st">&quot;Bob&quot;</span>, <span class="st">&quot;Charlie&quot;</span>)</span></code></pre></div>
<p>Arithmetic and relational operators also work on vectors. The
variables used above are in fact single element vectors. All operations
are carried out in element-wise fashion:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>numbers <span class="sc">*</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>## [1] 10  8 12 18 14</code></pre>
<p>In the above example each element of the vector <code>numbers</code>
is multiplied by the value 2.</p>
<p>You can access the items of a vector by using <code>[ ]</code>
brackets. The number in the bracket specifies the element to be
accessed:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>numbers[<span class="dv">2</span>] <span class="sc">*</span> <span class="dv">2</span> <span class="co"># Operation is only performed on the second element of the vector</span></span></code></pre></div>
<pre><code>## [1] 8</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>names[<span class="dv">1</span>] <span class="co"># Access the first element of the vector</span></span></code></pre></div>
<pre><code>## [1] &quot;Alice&quot;</code></pre>
</div>
<div id="matrices" class="section level3">
<h3>Matrices</h3>
<p>Matrices are two-dimensional arrays that hold elements of the same
type.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>my_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co"># Print the matrix</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>my_matrix</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9</code></pre>
<p>You can also create a matrix with strings:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>my_matrix2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="st">&quot;Alice&quot;</span>, <span class="st">&quot;Bob&quot;</span>, <span class="st">&quot;Charlie&quot;</span>, <span class="st">&quot;David&quot;</span>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co"># Print the matrix</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>my_matrix2</span></code></pre></div>
<pre><code>##      [,1]    [,2]     
## [1,] &quot;Alice&quot; &quot;Charlie&quot;
## [2,] &quot;Bob&quot;   &quot;David&quot;</code></pre>
<p>Same as with vectors, you can access the items of a matrix by using
<code>[ ]</code> brackets. The first number in the bracket specifies the
row-position, while the second number specifies the column-position:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>my_matrix[<span class="dv">3</span>,<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>my_matrix[<span class="dv">3</span>,] <span class="co"># This will access the entire third row</span></span></code></pre></div>
<pre><code>## [1] 3 6 9</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>my_matrix[,<span class="dv">1</span>] <span class="co"># This will access the entire first column</span></span></code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
</div>
<div id="data-frames" class="section level3">
<h3>Data Frames</h3>
<p>Data frames are tabular data structures where each column can contain
different types of data (e.g., numeric, character, factor).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>my_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>  <span class="at">ID =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="at">Name =</span> <span class="fu">c</span>(<span class="st">&quot;Alice&quot;</span>, <span class="st">&quot;Bob&quot;</span>, <span class="st">&quot;Charlie&quot;</span>, <span class="st">&quot;David&quot;</span>, <span class="st">&quot;Eva&quot;</span>),</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>  <span class="at">Score =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">78</span>, <span class="dv">92</span>, <span class="dv">88</span>)</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>)</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="co"># Print the data frame</span></span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>my_data</span></code></pre></div>
<pre><code>##   ID    Name Score
## 1  1   Alice    85
## 2  2     Bob    90
## 3  3 Charlie    78
## 4  4   David    92
## 5  5     Eva    88</code></pre>
<p>We can use single brackets <code>[ ]</code>, double brackets
<code>[[ ]]</code> or <code>$</code> to access columns from a data
frame:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>my_data[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>##      Name
## 1   Alice
## 2     Bob
## 3 Charlie
## 4   David
## 5     Eva</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>my_data[<span class="dv">1</span>,<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] &quot;Alice&quot;</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>my_data[[<span class="st">&quot;Name&quot;</span>]]</span></code></pre></div>
<pre><code>## [1] &quot;Alice&quot;   &quot;Bob&quot;     &quot;Charlie&quot; &quot;David&quot;   &quot;Eva&quot;</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>my_data<span class="sc">$</span>Name</span></code></pre></div>
<pre><code>## [1] &quot;Alice&quot;   &quot;Bob&quot;     &quot;Charlie&quot; &quot;David&quot;   &quot;Eva&quot;</code></pre>
</div>
<div id="lists" class="section level3">
<h3>Lists</h3>
<p>Lists are collections of objects that can contain elements of
different types and structures. Accessing elements of a list is done in
a similar way to accessing elements of a dataframe, a matrix, or a
vector:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>my_list <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>  <span class="at">numbers =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  <span class="at">matrix =</span> my_matrix,</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  <span class="at">data =</span> my_data</span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a><span class="co"># Print the list</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>my_list</span></code></pre></div>
<pre><code>## $numbers
## [1] 1 2 3 4 5
## 
## $matrix
##      [,1] [,2] [,3]
## [1,]    1    4    7
## [2,]    2    5    8
## [3,]    3    6    9
## 
## $data
##   ID    Name Score
## 1  1   Alice    85
## 2  2     Bob    90
## 3  3 Charlie    78
## 4  4   David    92
## 5  5     Eva    88</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>my_list<span class="sc">$</span>data <span class="co"># Only access data frame from list</span></span></code></pre></div>
<pre><code>##   ID    Name Score
## 1  1   Alice    85
## 2  2     Bob    90
## 3  3 Charlie    78
## 4  4   David    92
## 5  5     Eva    88</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a>my_list<span class="sc">$</span>data<span class="sc">$</span>Score <span class="co"># Only access the Score column from within data frame </span></span></code></pre></div>
<pre><code>## [1] 85 90 78 92 88</code></pre>
</div>
</div>
</div>
<div id="handling-data-files" class="section level1">
<h1>Handling Data Files</h1>
<p>A common task in data analysis is reading data from external files. R
supports a wide range of data file types through both built-in functions
and an extensive ecosystem of packages available on online repositories
such as CRAN and Bioconductor.</p>
<p>Native R formats like <code>.RData</code> and <code>.rds</code> are
managed with functions such as <code>load()</code> and
<code>readRDS()</code>, while text-based formats — including CSV, other
delimited files, and fixed-width files — can be handled with functions
like <code>read.csv()</code>, <code>read.table()</code>, and
<code>read.fwf()</code>, or with more specialised packages like
<strong>readr</strong>.</p>
<p>Spreadsheet files (e.g., Excel <code>.xls</code> and
<code>.xlsx</code>) are accessible via packages such as
<strong>readxl</strong> and <strong>openxlsx</strong>, and structured
formats like JSON and XML are supported through packages like
<strong>jsonlite</strong>, <strong>rjson</strong>,
<strong>xml2</strong>, and <strong>XML</strong>. In addition, R can
import data from statistical software formats (SAS, SPSS, Stata) using
packages like <strong>haven</strong> and <strong>foreign</strong>,
connect to SQL databases through <strong>DBI</strong> and specific
drivers (e.g., <strong>RSQLite</strong>, <strong>RMySQL</strong>,
<strong>RPostgreSQL</strong>), and work with big data formats like
Parquet via the <strong>arrow</strong> package.</p>
<p>Specialised formats such as HDF5 and NetCDF, as well as GIS and
spatial data formats, are also supported using packages like
<strong>rhdf5</strong>, <strong>ncdf4</strong>,
<strong>RNetCDF</strong>, <strong>sf</strong>, and
<strong>terra</strong>.</p>
<p>Here we consider data stored in a CSV (Comma-Separated Values) file,
as this is one of the most common formats used for storing tabular
data.</p>
<div id="reading-a-csv-file" class="section level2">
<h2>Reading a CSV File</h2>
<p>Use the <code>read.csv()</code> function to import a CSV file into R
as a data frame. The following example assumes that you have a file
named “east_coast_rivers.csv” in a sub-folder called “Data” that is
located in your working directory.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># Modify path and file name as needed</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>data <span class="ot">&lt;-</span> </span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  <span class="fu">read.csv</span>(<span class="st">&quot;./data/data_intro/east_coast_rivers.csv&quot;</span>, </span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>           <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<p>The CSV file contains cosmogenic beryllium-10 derived erosion rates
(<code>Erosion_Rate</code>) and various topographic and climatic metrics
(e.g., <code>Mean_Slope</code> and <code>Mean_Rainfall</code>) for
rivers draining the eastern seaboard of Australia. The data file also
includes several columns that identify the drainage basin (i.e.,
<code>Drainage_Basin</code> and <code>Basin_Code</code>) and whether the
data pertains to the main stem (<code>Group_No</code> = 1) or a
tributary (<code>Group_No</code> = 0).</p>
<p>The following will display the first few rows of the dataset:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a><span class="fu">head</span>(data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["SMPID2"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Group"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Group_No"],"name":[3],"type":["int"],"align":["right"]},{"label":["Drainage_Basin"],"name":[4],"type":["chr"],"align":["left"]},{"label":["Basin_Code"],"name":[5],"type":["int"],"align":["right"]},{"label":["Area_km2"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Cent_Lat"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Erosion_Rate"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Erosion_Rate_Error"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Mean_Slope"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Mean_Elevation"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Mean_Channel_Steepness"],"name":[12],"type":["dbl"],"align":["right"]},{"label":["Mean_Relief"],"name":[13],"type":["dbl"],"align":["right"]},{"label":["Mean_Rainfall"],"name":[14],"type":["dbl"],"align":["right"]}],"data":[{"1":"UOW01-MTC","2":"VIC","3":"1","4":"Mitchell-Thomson Rivers","5":"1","6":"3890.63","7":"-37.34","8":"10.92","9":"2.33","10":"363.5","11":"792.96","12":"154.03","13":"589.34","14":"1093.92","_rn_":"1"},{"1":"UOW01-TMB","2":"VIC","3":"1","4":"Mitchell-Thomson Rivers","5":"1","6":"2781.44","7":"-37.34","8":"13.18","9":"2.89","10":"252.7","11":"593.71","12":"111.71","13":"428.88","14":"854.66","_rn_":"2"},{"1":"UOW01-SNW","2":"VIC","3":"1","4":"Snowy River","5":"2","6":"13551.32","7":"-36.81","8":"9.79","9":"2.06","10":"185.3","11":"888.45","12":"103.59","13":"343.07","14":"829.88","_rn_":"3"},{"1":"UOW02-GTG","2":"VIC-Small","3":"0","4":"Snowy River","5":"2","6":"5.80","7":"-36.36","8":"24.57","9":"4.81","10":"298.7","11":"1837.06","12":"103.52","13":"525.99","14":"1641.86","_rn_":"4"},{"1":"UOW02-PPC","2":"VIC-Small","3":"0","4":"Snowy River","5":"2","6":"3.63","7":"-36.40","8":"17.81","9":"3.55","10":"143.8","11":"1748.80","12":"66.16","13":"371.67","14":"1577.14","_rn_":"5"},{"1":"UOW02-SNW-CP","2":"VIC-Small","3":"0","4":"Snowy River","5":"2","6":"20.67","7":"-36.45","8":"18.17","9":"3.62","10":"155.4","11":"1968.63","12":"87.65","13":"358.27","14":"1743.24","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p><code>read.csv()</code> assumes that the CSV file uses the comma
delimiter. If the CSV file you have uses a different delimiter (such as
a semicolon), you can use the <code>sep</code> parameter to specify the
delimiter used:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a>data_semicolon <span class="ot">&lt;-</span> </span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>  <span class="fu">read.csv</span>(<span class="st">&quot;./data/data01/east_coast_rivers_semicolon.csv&quot;</span>, </span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>           <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">&quot;;&quot;</span>)</span></code></pre></div>
</div>
<div id="writing-data-to-a-file" class="section level2">
<h2>Writing Data to a File</h2>
<p>After processing data, you might want to save your results. Use
<code>write.csv()</code> to export a data frame to a CSV file. In the
next example, we drop the second and fourth columns from the data frame
and then save to a new file:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># Specify the columns to drop.</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>columns_to_drop <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Group&quot;</span>,<span class="st">&quot;Drainage_Basin&quot;</span>) </span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a><span class="co"># Keep only columns NOT in &#39;columns_to_drop&#39;</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> data[, <span class="sc">!</span>(<span class="fu">names</span>(data) <span class="sc">%in%</span> columns_to_drop)] </span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a><span class="fu">head</span>(data_clean)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["SMPID2"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Group_No"],"name":[2],"type":["int"],"align":["right"]},{"label":["Basin_Code"],"name":[3],"type":["int"],"align":["right"]},{"label":["Area_km2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Cent_Lat"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Erosion_Rate"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["Erosion_Rate_Error"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["Mean_Slope"],"name":[8],"type":["dbl"],"align":["right"]},{"label":["Mean_Elevation"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["Mean_Channel_Steepness"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["Mean_Relief"],"name":[11],"type":["dbl"],"align":["right"]},{"label":["Mean_Rainfall"],"name":[12],"type":["dbl"],"align":["right"]}],"data":[{"1":"UOW01-MTC","2":"1","3":"1","4":"3890.63","5":"-37.34","6":"10.92","7":"2.33","8":"363.5","9":"792.96","10":"154.03","11":"589.34","12":"1093.92","_rn_":"1"},{"1":"UOW01-TMB","2":"1","3":"1","4":"2781.44","5":"-37.34","6":"13.18","7":"2.89","8":"252.7","9":"593.71","10":"111.71","11":"428.88","12":"854.66","_rn_":"2"},{"1":"UOW01-SNW","2":"1","3":"2","4":"13551.32","5":"-36.81","6":"9.79","7":"2.06","8":"185.3","9":"888.45","10":"103.59","11":"343.07","12":"829.88","_rn_":"3"},{"1":"UOW02-GTG","2":"0","3":"2","4":"5.80","5":"-36.36","6":"24.57","7":"4.81","8":"298.7","9":"1837.06","10":"103.52","11":"525.99","12":"1641.86","_rn_":"4"},{"1":"UOW02-PPC","2":"0","3":"2","4":"3.63","5":"-36.40","6":"17.81","7":"3.55","8":"143.8","9":"1748.80","10":"66.16","11":"371.67","12":"1577.14","_rn_":"5"},{"1":"UOW02-SNW-CP","2":"0","3":"2","4":"20.67","5":"-36.45","6":"18.17","7":"3.62","8":"155.4","9":"1968.63","10":"87.65","11":"358.27","12":"1743.24","_rn_":"6"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># Write cleaned data to file</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a><span class="fu">write.csv</span>(data_clean, </span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>          <span class="at">file =</span> <span class="st">&quot;./data/data_intro/east_coast_rivers_cleaned.csv&quot;</span>, </span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>          <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</div>
</div>
<div id="plotting-in-r" class="section level1">
<h1>Plotting in R</h1>
<p>Visualizing data is crucial for understanding patterns and insights.
R offers several plotting systems; here, we cover the base plotting
system and provide an introduction to the <em>Tidyverse</em> R ecosystem
that includes the popular <strong>ggplot2</strong> plotting package.</p>
<div id="base-r-plotting" class="section level2">
<h2>Base R Plotting</h2>
<p>The base plotting functions in R are straightforward and useful for
quick visualizations.</p>
<div id="example-math-functions" class="section level3">
<h3>Example: Math Functions</h3>
<p>You can treat R like a graphing calculator, using the
<code>curve()</code> function. Try, for example, typing in the following
statement:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">cos</span>(x), <span class="at">from=</span><span class="sc">-</span><span class="dv">3</span><span class="sc">*</span>pi, <span class="at">to=</span><span class="dv">3</span><span class="sc">*</span>pi)</span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-17-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>This statement plots the cosine function <span
class="math inline">\(f(x) = \cos(x)\)</span> over the domain <span
class="math inline">\(-3\pi \le x \le 3\pi\)</span>. The three inputs to
the <code>curve()</code> function are called <em>arguments</em>:</p>
<ul>
<li><code>cos(x)</code> is the curve to plot</li>
<li><code>from=-3*pi</code> and <code>to=3*pi</code> indicate to R that
you want to start the curve at <span
class="math inline">\(x=-3\pi\)</span> and end it at <span
class="math inline">\(x=3\pi\)</span>.</li>
</ul>
</div>
<div id="example-scatter-plot" class="section level3">
<h3>Example: Scatter Plot</h3>
<p>To produce a simple scatter plot, use the <code>plot</code> function.
In the next example we will use the CSV file we loaded earlier and plot
erosion rate versus mean slope.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># Assign data to x and y</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> data<span class="sc">$</span>Mean_Slope</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> data<span class="sc">$</span>Erosion_Rate</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a><span class="fu">plot</span>(x, y,</span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Scatter Plot of Erosion Rate vs. Mean Slope&quot;</span>,</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Mean basin slope [m/km]&quot;</span>,</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Erosion rate [mm/kyr]&quot;</span>,</span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">1</span>,  <span class="co"># 0 is for a square, 1 is for a circle, 3 is for a triangle...</span></span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-18-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>The following chunk of R script will plot only those data that
originate from tributary channels (i.e., <code>Group_No</code> = 0). It
will also fit a liner model through the data using the <code>lm()</code>
function:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co"># Subset the data based on a condition in a different column</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a>subset_data <span class="ot">&lt;-</span> data[data<span class="sc">$</span>Group_No <span class="sc">==</span> <span class="st">&quot;0&quot;</span>, ]</span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a><span class="co"># Assign data to x and y</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>x <span class="ot">&lt;-</span> subset_data<span class="sc">$</span>Mean_Slope</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> subset_data<span class="sc">$</span>Erosion_Rate</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a></span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a><span class="co"># Create a scatter plot</span></span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a><span class="fu">plot</span>(x, y,</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Scatter Plot of Erosion Rate vs. Mean Slope&quot;</span>,</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Mean basin slope [m/km]&quot;</span>,</span>
<span id="cb53-12"><a href="#cb53-12" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Erosion rate [mm/kyr]&quot;</span>,</span>
<span id="cb53-13"><a href="#cb53-13" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">1</span>,  <span class="co"># 0 is for a square, 1 is for a circle, 3 is for a triangle...</span></span>
<span id="cb53-14"><a href="#cb53-14" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb53-15"><a href="#cb53-15" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" tabindex="-1"></a><span class="co"># Fit a linear model to the data</span></span>
<span id="cb53-17"><a href="#cb53-17" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> subset_data)</span>
<span id="cb53-18"><a href="#cb53-18" tabindex="-1"></a></span>
<span id="cb53-19"><a href="#cb53-19" tabindex="-1"></a><span class="co"># Generate a sequence of x values over the range of the data for plotting the trendline</span></span>
<span id="cb53-20"><a href="#cb53-20" tabindex="-1"></a>newx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="fu">max</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb53-21"><a href="#cb53-21" tabindex="-1"></a><span class="co"># Predict y values from the model based on the sequence of x values</span></span>
<span id="cb53-22"><a href="#cb53-22" tabindex="-1"></a>newy <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> newx))</span>
<span id="cb53-23"><a href="#cb53-23" tabindex="-1"></a></span>
<span id="cb53-24"><a href="#cb53-24" tabindex="-1"></a><span class="co"># Add the trendline to the plot</span></span>
<span id="cb53-25"><a href="#cb53-25" tabindex="-1"></a><span class="fu">lines</span>(newx, newy, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-19-1.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="example-histogram" class="section level3">
<h3>Example: Histogram</h3>
<p>The next example creates a histogram of mean basin slope values
stored in the <code>Mean_Slope</code> column of the CSV file loaded
earlier:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># Assign data to x</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> data<span class="sc">$</span>Mean_Slope</span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a><span class="co"># Plot histogram</span></span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a><span class="fu">hist</span>(x,</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Histogram of Mean Slope&quot;</span>,</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Mean basin slope [m/km]&quot;</span>,</span>
<span id="cb54-8"><a href="#cb54-8" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>,</span>
<span id="cb54-9"><a href="#cb54-9" tabindex="-1"></a>     <span class="at">border =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-20-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p>We can show multiple plots side by side using the <code>par</code>
function. In the next example we plot three histograms for selected
columns from the loaded CSV file and overlay kernel density curves on
top of each histogram:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># Define a vector of column names for which you want smoother histograms</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mean_Slope&quot;</span>, <span class="st">&quot;Mean_Rainfall&quot;</span>,<span class="st">&quot;Erosion_Rate&quot;</span>)</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a><span class="co"># Set up the plotting area:</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a><span class="co"># 1 row with as many columns as there are elements in &#39;cols&#39;</span></span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">length</span>(cols)))</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a><span class="co"># Loop through each specified column and plot its histogram</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a><span class="co"># with an overlaid density curve</span></span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a><span class="cf">for</span> (col <span class="cf">in</span> cols) {</span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>  <span class="co"># Extract data for the current column</span></span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data[[col]]</span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>  </span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>  <span class="co"># Plot histogram with density scaling (freq = FALSE) so that</span></span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>  <span class="co"># the y-axis represents a density</span></span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>  <span class="fu">hist</span>(x,</span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;Histogram of&quot;</span>, col),</span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>       <span class="at">xlab =</span> col,</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;lightgreen&quot;</span>,</span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>       <span class="at">border =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb55-21"><a href="#cb55-21" tabindex="-1"></a>       <span class="at">freq =</span> <span class="cn">FALSE</span>)  <span class="co"># Use density instead of counts</span></span>
<span id="cb55-22"><a href="#cb55-22" tabindex="-1"></a>  </span>
<span id="cb55-23"><a href="#cb55-23" tabindex="-1"></a>  <span class="co"># Compute the kernel density estimate</span></span>
<span id="cb55-24"><a href="#cb55-24" tabindex="-1"></a>  dens <span class="ot">&lt;-</span> <span class="fu">density</span>(x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-25"><a href="#cb55-25" tabindex="-1"></a>  </span>
<span id="cb55-26"><a href="#cb55-26" tabindex="-1"></a>  <span class="co"># Overlay the density curve (kernel density estimate)</span></span>
<span id="cb55-27"><a href="#cb55-27" tabindex="-1"></a>  <span class="fu">lines</span>(dens, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb55-28"><a href="#cb55-28" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-21-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>Explanation:</strong></p>
<ul>
<li><p>The <code>cols</code> vector lists the column names from your
data frame for which you want to generate histograms.</p></li>
<li><p><code>par(mfrow = c(1, length(cols)))</code> arranges the
plotting window into one row and as many columns as there are elements
in <code>cols</code>, so that the histograms appear in a single
line.</p></li>
<li><p>The <code>for</code> loop iterates through each column name in
<code>cols</code>, uses <code>data[[col]]</code> to extract the column
from the data frame, and then calls <code>hist()</code> to plot the
histogram. The title and x-axis label are dynamically generated using
<code>paste("Histogram of", col)</code>.</p></li>
<li><p>The <code>hist()</code> function is used with the argument
<code>freq = FALSE</code>, which scales the y-axis to represent
probability densities rather than raw counts. This makes it easier to
overlay the kernel density estimate.</p></li>
<li><p>The <code>density()</code> function calculates a smoothed density
estimate of the data. The resulting density curve is then added to the
histogram using <code>lines()</code>, providing a smoother
appearance.</p></li>
</ul>
</div>
</div>
<div id="tidyverse-and-ggplot2" class="section level2">
<h2>Tidyverse and ggplot2</h2>
<p>The <em>Tidyverse</em> is a cohesive ecosystem of R packages that
share a common design philosophy and data structures, making data
manipulation, visualization, and analysis more intuitive. The Tidyverse
emphasises the concept of “tidy data”, where each variable is a column,
each observation is a row, and each type of observational unit forms a
table. Core packages include:</p>
<ul>
<li><code>ggplot2</code>: for creating sophisticated data
visualizations.</li>
<li><code>dplyr</code>: for efficient data manipulation.</li>
<li><code>tidyr</code>: for tidying and reshaping data.</li>
<li><code>readr</code>: for fast data import.</li>
<li><code>purrr</code>: for functional programming and iterative
operations.</li>
</ul>
<p>Together, these packages facilitate reproducible and streamlined data
workflows, making the Tidyverse a popular choice among both beginners
and seasoned data scientists.</p>
<div id="installing-the-tidyverse" class="section level3">
<h3>Installing the Tidyverse</h3>
<p>Before you can use the Tidyverse packages, you need to install and
load them into your R session. Run the following command in your R
console to install the Tidyverse (if it isn’t already installed):</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<p>Load the Tidyverse library by running:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<p>This command loads several core packages (including,
<strong>dplyr</strong>, <strong>ggplot2</strong>,
<strong>tidyr</strong>, <strong>readr</strong>), some of which we will
use for different tasks next.</p>
</div>
<div id="data-wrangling-with-dplyr" class="section level3">
<h3>Data wrangling with dplyr</h3>
<p>In the next example we use functions from the <strong>dplyr</strong>
package to filter our data and remove all data points with
<code>Group_No</code> not equal to zero (i.e, main stem samples), and
then calculate the median and mean erosion rate and basin slope for each
river basin (i.e., we group data together based on
<code>Basin_Code</code>):</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="co"># Use dplyr functions to filter and arrange the data</span></span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="co"># Below &quot;data&quot; is the name we assigned earlier to the CSV file</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>  <span class="fu">filter</span>(Group_No <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="co"># Leave only basins with Group_No = 0</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>  <span class="fu">group_by</span>(Basin_Code) <span class="sc">%&gt;%</span>  <span class="co"># Group by Basin_Code</span></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">c</span>(<span class="st">&quot;Erosion_Rate&quot;</span>, <span class="st">&quot;Mean_Slope&quot;</span>),<span class="fu">list</span>(mean,median)) <span class="co"># Calc. mean and median</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a><span class="co"># Display the filtered data</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a><span class="fu">head</span>(filtered_data)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Basin_Code"],"name":[1],"type":["int"],"align":["right"]},{"label":["Erosion_Rate_fn1"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean_Slope_fn1"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Erosion_Rate_fn2"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Mean_Slope_fn2"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"2","2":"22.40000","3":"202.5000","4":"18.17","5":"178.00"},{"1":"4","2":"26.98500","3":"186.6929","4":"24.69","5":"172.10"},{"1":"10","2":"18.82000","3":"133.8500","4":"18.82","5":"133.85"},{"1":"11","2":"22.21000","3":"212.9500","4":"22.21","5":"212.95"},{"1":"18","2":"20.03111","3":"187.1556","4":"17.63","5":"190.90"},{"1":"19","2":"29.28000","3":"194.7000","4":"29.50","5":"199.80"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In the above example <code>%&gt;%</code> is the pipe operator that
passes the result from one function to the next.</p>
</div>
<div id="plotting-with-ggplot2" class="section level3">
<h3>Plotting with ggplot2</h3>
<div id="example-1" class="section level4">
<h4>Example 1</h4>
<p>The following example uses the <strong>dplyr</strong> package to
filter the data so that drainage basins with less than five data points
are dropped (i.e., if “Drainage_Basin” — or “Basin_Code” as the two
represent the same — has less than five entries, that basin is dropped).
It then uses <strong>ggplot2</strong> to display box plots of erosion
rate values for each basin.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="co"># Filter out groups with less than 5 data points</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>  <span class="fu">group_by</span>(Drainage_Basin) <span class="sc">%&gt;%</span></span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a><span class="co"># Create the box plot using the filtered data</span></span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a><span class="fu">ggplot</span>(filtered_data, </span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Drainage_Basin, </span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>           <span class="at">y =</span> Erosion_Rate, </span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>           <span class="at">fill =</span> Drainage_Basin)</span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb59-15"><a href="#cb59-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Box Plot of Erosion Rate by Drainage Basin&quot;</span>,</span>
<span id="cb59-16"><a href="#cb59-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Drainage Basin&quot;</span>,</span>
<span id="cb59-17"><a href="#cb59-17" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Erosion Rate [mm/kyr]&quot;</span></span>
<span id="cb59-18"><a href="#cb59-18" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-25-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>Explanation:</strong></p>
<ul>
<li><p>We use <code>group_by(Drainage_Basin)</code> to group the data by
the <code>Drainage_Basin</code> column.</p></li>
<li><p><code>filter(n() &gt;= 5)</code> retains only those groups that
have five or more observations.</p></li>
<li><p><code>ungroup()</code> is called afterward to remove the grouping
before plotting.</p></li>
<li><p>The filtered dataset (<code>filtered_data</code>) is then passed
to <code>ggplot()</code>.</p></li>
<li><p>A box plot is created with <code>geom_boxplot()</code>, and the
aesthetics are mapped accordingly.</p></li>
</ul>
</div>
<div id="example-2" class="section level4">
<h4>Example 2</h4>
<p>In the next example we use <strong>ggplot2</strong> to display
scatter plots for each drainage basins, plotting erosion rate vs. mean
slope:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># Filter out groups with less than 5 data points and </span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="co"># add an index within each group for plotting</span></span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>data_filtered <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a>  <span class="fu">group_by</span>(Drainage_Basin) <span class="sc">%&gt;%</span></span>
<span id="cb60-5"><a href="#cb60-5" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb60-6"><a href="#cb60-6" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb60-7"><a href="#cb60-7" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" tabindex="-1"></a><span class="co"># Create the scatter plot with separate panels for each Drainage_Basin group</span></span>
<span id="cb60-9"><a href="#cb60-9" tabindex="-1"></a><span class="fu">ggplot</span>(data_filtered, </span>
<span id="cb60-10"><a href="#cb60-10" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> Mean_Slope, <span class="at">y =</span> Erosion_Rate)</span>
<span id="cb60-11"><a href="#cb60-11" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb60-12"><a href="#cb60-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Drainage_Basin, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb60-15"><a href="#cb60-15" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter Plot of Erosion Rate vs. Mean Slope by Drainage Basin&quot;</span>,</span>
<span id="cb60-16"><a href="#cb60-16" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Mean Basin Slope [m/km]&quot;</span>,</span>
<span id="cb60-17"><a href="#cb60-17" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Erosion Rate [mm/kyr]&quot;</span></span>
<span id="cb60-18"><a href="#cb60-18" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-26-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p><strong>Explanation:</strong></p>
<ul>
<li><p><code>geom_point(...)</code>: Adds the scatter plot
points.</p></li>
<li><p><code>facet_wrap(~ Drainage_Basin, scales = "free")</code>:
Creates separate panels for each level of <code>Drainage_Basin</code>.
The option <code>scales = "free"</code> allows each panel to have its
own x-axis and y-axis scales (since the magnitude of values may differ
across groups).</p></li>
</ul>
<p>To add error bars to the above plot, we can modify the code as
follows:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="fu">ggplot</span>(data_filtered, <span class="fu">aes</span>(<span class="at">x =</span> Mean_Slope, <span class="at">y =</span> Erosion_Rate)) <span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> Erosion_Rate <span class="sc">-</span> Erosion_Rate_Error,</span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>                    <span class="at">ymax =</span> Erosion_Rate <span class="sc">+</span> Erosion_Rate_Error),</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Drainage_Basin, <span class="at">scales =</span> <span class="st">&quot;free&quot;</span>) <span class="sc">+</span></span>
<span id="cb61-7"><a href="#cb61-7" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb61-8"><a href="#cb61-8" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Scatter Plot of Erosion Rate vs. Mean Slope by Drainage Basin&quot;</span>,</span>
<span id="cb61-9"><a href="#cb61-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Mean Basin Slope [m/km]&quot;</span>,</span>
<span id="cb61-10"><a href="#cb61-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Erosion Rate [mm/kyr]&quot;</span></span>
<span id="cb61-11"><a href="#cb61-11" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-27-1.png" width="80%" style="display: block; margin: auto;" /></p>
</div>
<div id="example-3" class="section level4">
<h4>Example 3</h4>
<p>In the final example, we use <strong>ggplot2</strong> to do a
correlation matrix using erosion rate and a number of topographic and
climatic metrics. Before we can proceed we need to install the
<strong>GGally</strong> package that extends the functionality of
<strong>ggplot2</strong>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;GGally&quot;</span>)</span></code></pre></div>
<p>Load the <strong>GGally</strong> package by running:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<p>Make the plot:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="co"># Filter data to drop certain columns</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>data_clean <span class="ot">&lt;-</span> data_filtered <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>SMPID2,</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>         <span class="sc">-</span>Group,</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a>         <span class="sc">-</span>Group_No,</span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>         <span class="sc">-</span>Basin_Code,</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>         <span class="sc">-</span>Area_km2,</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>         <span class="sc">-</span>Cent_Lat,</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a>         <span class="sc">-</span>Erosion_Rate_Error,</span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>         <span class="sc">-</span>Mean_Channel_Steepness</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a><span class="co"># Rename remaining columns with sorter names </span></span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Eros.Rate =</span> Erosion_Rate,</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a>         <span class="at">Slope =</span> Mean_Slope,</span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a>         <span class="at">Elevation =</span> Mean_Elevation,</span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a>         <span class="at">Relief =</span> Mean_Relief,</span>
<span id="cb64-17"><a href="#cb64-17" tabindex="-1"></a>         <span class="at">Rainfall =</span> Mean_Rainfall</span>
<span id="cb64-18"><a href="#cb64-18" tabindex="-1"></a>         ) <span class="sc">%&gt;%</span></span>
<span id="cb64-19"><a href="#cb64-19" tabindex="-1"></a><span class="co"># Filter out groups with less than 15 data points</span></span>
<span id="cb64-20"><a href="#cb64-20" tabindex="-1"></a>  <span class="fu">group_by</span>(Drainage_Basin) <span class="sc">%&gt;%</span></span>
<span id="cb64-21"><a href="#cb64-21" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">n</span>() <span class="sc">&gt;=</span> <span class="dv">15</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb64-22"><a href="#cb64-22" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb64-23"><a href="#cb64-23" tabindex="-1"></a></span>
<span id="cb64-24"><a href="#cb64-24" tabindex="-1"></a><span class="co"># Inspect filtered data</span></span>
<span id="cb64-25"><a href="#cb64-25" tabindex="-1"></a><span class="fu">head</span>(data_clean)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["Drainage_Basin"],"name":[1],"type":["chr"],"align":["left"]},{"label":["Eros.Rate"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Slope"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Elevation"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Relief"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["Rainfall"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"Bega River","2":"21.34","3":"227.3","4":"405.61","5":"388.48","6":"920.06"},{"1":"Bega River","2":"15.86","3":"151.5","4":"163.66","5":"222.58","6":"889.26"},{"1":"Bega River","2":"13.34","3":"146.4","4":"165.16","5":"228.47","6":"887.43"},{"1":"Bega River","2":"13.70","3":"83.5","4":"115.40","5":"115.54","6":"857.26"},{"1":"Bega River","2":"16.87","3":"130.9","4":"153.55","5":"232.60","6":"908.95"},{"1":"Bega River","2":"21.33","3":"173.6","4":"318.37","5":"303.20","6":"926.24"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a><span class="co"># Plot correlation matrix</span></span>
<span id="cb65-2"><a href="#cb65-2" tabindex="-1"></a><span class="fu">ggpairs</span>(data_clean,   <span class="co"># Data frame</span></span>
<span id="cb65-3"><a href="#cb65-3" tabindex="-1"></a>        <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span> <span class="co"># Columns to plot</span></span>
<span id="cb65-4"><a href="#cb65-4" tabindex="-1"></a>        ) </span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-30-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p><strong>Explanation:</strong></p>
<ul>
<li><p>The <code>select()</code> function is used to choose
columns.</p></li>
<li><p>By preceding column names with a minus sign (<code>-</code>), you
indicate that these columns should be removed.</p></li>
</ul>
<p>Next we will group the data using <code>Drainage_Basin</code> and
redo the plot:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co"># Plot correlation matrix with groups</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="fu">ggpairs</span>(data_clean,                       <span class="co"># Data frame</span></span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>   <span class="at">columns =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>,                         <span class="co"># Columns to plot</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>   <span class="fu">aes</span>(<span class="at">color =</span> Drainage_Basin,            <span class="co"># Color by basins</span></span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>       <span class="at">alpha =</span> <span class="fl">0.5</span>),                      <span class="co"># Transparency</span></span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>   <span class="at">upper =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="fu">wrap</span>(<span class="st">&quot;cor&quot;</span>, <span class="at">size =</span> <span class="fl">2.5</span>)), <span class="co"># Font size in the upper panels</span></span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>   <span class="at">lower =</span> <span class="fu">list</span>(<span class="at">continuous =</span> <span class="st">&quot;smooth&quot;</span>)    <span class="co"># Add trend lines to scatter plots</span></span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a>   ) </span></code></pre></div>
<p><img src="r1_files/figure-html/unnamed-chunk-31-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
</div>
<div id="summary" class="section level1">
<h1>Summary</h1>
<p>In this introduction, we covered the essentials of R, including basic
syntax, data structures, reading data files, and plotting. We explored
each of these fundamental components step-by-step to build a solid
foundation for your data analysis skills. By the end, you should had
acquired a working knowledge of how to handle common data analysis tasks
in R. In Practical No. 2 we will explore the basics of handling spatial
data in R.</p>
</div>
<div id="list-of-r-functions" class="section level1">
<h1>List of R functions</h1>
<p>This practical showcased a diverse range of R functions. A summary of
these is presented below:</p>
<p><strong>base R functions</strong></p>
<ul>
<li><p><code>c()</code>: concatenates its arguments to create a vector,
which is one of the most fundamental data structures in R. It is used to
combine numbers, strings, and other objects into a single
vector.</p></li>
<li><p><code>cos()</code>: computes the cosine of an angle provided in
radians, serving as a basic trigonometric operation in R. It is commonly
used in mathematical computations and plotting periodic
functions.</p></li>
<li><p><code>curve()</code>: plots a curve based on a mathematical
expression over a specified range of x values. It is useful for quickly
visualizing functions without the need to generate a complete
dataset.</p></li>
<li><p><code>data.frame()</code>: creates a table-like structure where
each column can hold different types of data. It is a primary data
structure for storing and manipulating datasets in R.</p></li>
<li><p><code>density()</code>: computes a kernel density estimate to
provide a smoothed approximation of a continuous variable’s
distribution. It is often used to visualise the underlying probability
density in data.</p></li>
<li><p><code>head()</code>: returns the first few elements or rows of an
object, such as a vector, matrix, or data frame. It is a convenient tool
for quickly inspecting the structure and content of data.</p></li>
<li><p><code>hist()</code>: creates a histogram to display the frequency
distribution of a numerical dataset. It is a fundamental tool for
exploring the shape and spread of data distributions.</p></li>
<li><p><code>install.packages()</code>: downloads and installs R
packages from CRAN or other repositories into your local library. It
extends R’s functionality by providing access to additional tools and
resources.</p></li>
<li><p><code>library()</code>: loads an installed package into the
current R session, making its functions and datasets available. It is
essential for expanding R’s capabilities by using external
packages.</p></li>
<li><p><code>lines()</code>: adds line segments to an existing plot,
allowing you to overlay additional information such as trend lines or
fitted curves. It is often used to enhance visualizations by
supplementing existing plots.</p></li>
<li><p><code>list()</code>: creates an ordered collection that can store
elements of different types and sizes. It is a flexible data structure
that can hold vectors, matrices, data frames, and even other
lists.</p></li>
<li><p><code>lm()</code>: fits linear models to data using the method of
least squares, enabling regression analysis. It is widely used for
modeling relationships between a dependent variable and one or more
independent variables.</p></li>
<li><p><code>matrix()</code>: constructs a matrix by arranging a
sequence of elements into specified rows and columns. It is fundamental
for performing matrix computations and linear algebra operations in
R.</p></li>
<li><p><code>max()</code>: returns the largest value from a set of
numbers or a numeric vector. It is used to identify the upper bound of
data values in a dataset.</p></li>
<li><p><code>mean()</code>: calculates the arithmetic average of a
numeric vector, representing the central tendency of the data. It is a
basic statistical measure frequently used in data analysis.</p></li>
<li><p><code>median()</code>: returns the middle value of a sorted
numeric vector, providing a robust measure of central tendency. It is
particularly useful when the data distribution is skewed or contains
outliers.</p></li>
<li><p><code>min()</code>: returns the smallest value from a set of
numbers or a numeric vector. It is commonly used to determine the lower
bound of a dataset.</p></li>
<li><p><code>names()</code>: retrieves or sets the names attribute of an
object, such as the column names of a data frame or the element names of
a list. It is crucial for managing and accessing labels within R data
structures.</p></li>
<li><p><code>par()</code>: sets or queries graphical parameters in R,
such as margins, layout, and plotting symbols. It provides fine control
over the appearance and arrangement of plots.</p></li>
<li><p><code>paste()</code>: concatenates strings together, converting
non-character data into character format as needed. It is commonly used
to generate dynamic labels, messages, or file names in R.</p></li>
<li><p><code>plot()</code>: is a generic plotting function that creates
various types of graphs, including scatter plots and line charts. It
serves as the foundation of base R graphics, allowing for flexible data
visualization.</p></li>
<li><p><code>predict()</code>: generates predicted values from a fitted
model object using new data if provided. It is a key tool for model
evaluation and forecasting in regression analysis.</p></li>
<li><p><code>read.csv()</code>: imports data from a CSV file into R by
converting it into a data frame. It automatically handles
comma-separated values and is widely used for data import.</p></li>
<li><p><code>seq()</code>: generates regular sequences of numbers based
on specified start, end, and increment values. It is essential for
creating vectors that represent ranges or intervals.</p></li>
<li><p><code>write.csv()</code>: exports a data frame to a CSV file,
enabling you to save processed data to disk. It is commonly used for
sharing results with other applications or collaborators.</p></li>
</ul>
<p><strong>tidyverse functions</strong></p>
<ul>
<li><p><code>%&gt;%</code> (pipe operator): passes the output of one
function directly as the input to the next, creating a clear and
readable chain of operations. It is a hallmark of the tidyverse,
promoting an intuitive coding style.</p></li>
<li><p><code>aes()</code>: defines aesthetic mappings in ggplot2 by
linking data variables to visual properties such as color, size, and
shape. It serves as the blueprint for representing data accurately in
plots.</p></li>
<li><p><code>facet_wrap()</code>: splits a ggplot2 plot into multiple
panels based on a factor variable, allowing for side-by-side comparison
of subsets. It automatically arranges panels into a grid to reveal
patterns across groups.</p></li>
<li><p><code>filter()</code>: subsets rows of a data frame based on
specified logical conditions. It is a fundamental tool for extracting
relevant data from a dataset.</p></li>
<li><p><code>geom_boxplot()</code>: creates box-and-whisker plots in
ggplot2, summarizing data distributions through quartiles and
highlighting outliers. It is a powerful tool for comparing distributions
across groups.</p></li>
<li><p><code>geom_errorbar()</code>: overlays error bars on a ggplot2
plot to represent variability or uncertainty in the data. It is commonly
used to display confidence intervals or standard errors alongside data
points.</p></li>
<li><p><code>geom_point()</code>: adds points to a ggplot2 plot,
producing scatter plots that depict the relationship between two
continuous variables. It is a fundamental component for visualizing
individual observations.</p></li>
<li><p><code>ggplot()</code>: initialises a ggplot object and
establishes the framework for creating plots using the grammar of
graphics. It allows for incremental addition of layers, scales, and
themes to build complex visualizations.</p></li>
<li><p><code>group_by()</code>: organises a data frame into groups based
on one or more variables, preparing it for aggregate operations. It
facilitates calculations within each subset of data.</p></li>
<li><p><code>labs()</code>: allows you to add or modify labels in a
ggplot2 plot, such as titles, axis labels, and captions. It enhances the
readability and interpretability of visualizations.</p></li>
<li><p><code>n()</code>: returns the number of observations within the
current group, typically used inside summarise() to count rows. It is
useful for quantifying the size of data groups.</p></li>
<li><p><code>rename()</code>: changes column names in a data frame to
make them more descriptive or consistent. It is an important tool for
data cleaning and organization.</p></li>
<li><p><code>summarise_at()</code>: applies summary functions to
specified columns of a data frame, usually within grouped data. It
streamlines the calculation of multiple summary statistics for selected
variables.</p></li>
<li><p><code>select()</code>: extracts specific columns from a data
frame, simplifying data manipulation by excluding unwanted variables. It
is used to create a streamlined dataset for analysis.</p></li>
<li><p><code>ungroup()</code>: removes grouping from a data frame that
was previously grouped using group_by(). It resets the data structure to
prevent unintended effects on subsequent analyses.</p></li>
</ul>
<p><strong>GGally functions</strong></p>
<ul>
<li><p><code>ggpairs()</code>: creates a matrix of plots that displays
pairwise relationships among multiple variables. It provides an
at-a-glance view of correlations and distributions in multivariate
datasets.</p></li>
<li><p><code>wrap()</code>: customises individual plot elements such as
text or correlation labels in GGally. It allows adjustments to
appearance and formatting for clearer visualization.</p></li>
</ul>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
